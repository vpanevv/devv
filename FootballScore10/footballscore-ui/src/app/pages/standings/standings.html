<div class="container">

    <!-- Header -->
    <div class="hero">
        <div class="heroTitle">League table standing</div>

        <div class="heroActions">
            <a class="btn btn-primary" routerLink="/teams/create">+ Add Team</a>
        </div>
    </div>

    <!-- Match form -->
    <div class="card matchCard">
        <div class="cardTitle">Create match</div>
        <div class="cardSub">Pick teams, enter score, save — standings will update.</div>

        <div *ngIf="matchError" class="alert error">{{ matchError }}</div>

        <form class="matchGrid" [formGroup]="matchForm" (ngSubmit)="createMatch()">
            <div class="field">
                <label class="label">Home team</label>
                <select class="select" formControlName="homeTeamId">
                    <option [ngValue]="null" disabled>Select team…</option>
                    <option *ngFor="let t of items" [ngValue]="t.teamId">{{ t.name }}</option>
                </select>
            </div>

            <div class="field">
                <label class="label">Away team</label>
                <select class="select" formControlName="awayTeamId">
                    <option [ngValue]="null" disabled>Select team…</option>
                    <option *ngFor="let t of items" [ngValue]="t.teamId">{{ t.name }}</option>
                </select>
            </div>

            <div class="field">
                <label class="label">Home goals</label>
                <input class="input" type="number" min="0" formControlName="homeGoals" />
            </div>

            <div class="field">
                <label class="label">Away goals</label>
                <input class="input" type="number" min="0" formControlName="awayGoals" />
            </div>

            <div class="field">
                <label class="label">Date played</label>
                <input class="input" type="date" formControlName="datePlayed" />
            </div>

            <div class="matchActions">
                <button type="button" class="btn" (click)="swapTeams()">Swap</button>
                <button class="btn btn-primary" type="submit" [disabled]="isCreatingMatch">
                    {{ isCreatingMatch ? 'Saving…' : 'Create match' }}
                </button>
            </div>
        </form>
    </div>

    <!-- States -->
    <div *ngIf="isLoading" class="state">Loading…</div>
    <div *ngIf="error" class="alert error">{{ error }}</div>

    <!-- Table -->
    <div *ngIf="!isLoading && !error" class="card tableCard">
        <table class="table">
            <thead>
                <tr>
                    <th class="num">#</th>
                    <th>Team</th>
                    <th class="num">P</th>
                    <th class="num">W</th>
                    <th class="num">D</th>
                    <th class="num">L</th>
                    <th class="num">GD</th>
                    <th class="num">Pts</th>
                    <th class="num">Actions</th>
                </tr>
            </thead>

            <tbody>
                <tr *ngFor="let x of items">
                    <td class="num"><b>{{ x.position }}</b></td>

                    <td class="team">
                        <span class="dot"></span>
                        {{ x.name }}
                    </td>

                    <td class="num">{{ x.played }}</td>
                    <td class="num">{{ x.wins }}</td>
                    <td class="num">{{ x.draws }}</td>
                    <td class="num">{{ x.loses }}</td>
                    <td class="num" [ngClass]="gdClass(x.goalDifference)">{{ gdLabel(x.goalDifference) }}</td>
                    <td class="num pts"><b>{{ x.points }}</b></td>

                    <td class="num">
                        <div class="rowActions">
                            <a class="btn btn-sm" [routerLink]="['/teams', x.teamId, 'edit']">Edit</a>
                            <button class="btn btn-sm btn-danger" type="button" (click)="openDelete(x.teamId, x.name)">
                                Delete
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- confirm delete -->
        <div *ngIf="confirmOpen && pendingDelete" class="confirmBar">
            <div class="confirmTitle">Delete team</div>
            <div class="confirmText">
                Are you sure you want to delete <b>{{ pendingDelete.name }}</b>? This cannot be undone.
            </div>

            <div class="confirmActions">
                <button class="btn btn-sm" type="button" (click)="closeDelete()" [disabled]="isDeleting">Cancel</button>
                <button class="btn btn-sm btn-danger" type="button" (click)="confirmDelete()" [disabled]="isDeleting">
                    {{ isDeleting ? 'Deleting…' : 'Delete' }}
                </button>
            </div>
        </div>

    </div>
</div>